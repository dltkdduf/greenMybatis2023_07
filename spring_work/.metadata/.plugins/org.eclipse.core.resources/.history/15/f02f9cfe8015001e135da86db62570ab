package aaa.control;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import aaa.db.BoardDTO;
import aaa.db.BoardMapper;
import jakarta.annotation.Resource;

@Controller
public class DBController {

	@Resource
	BoardMapper bm;
	
	@RequestMapping("/db/list")
	String dbListttt(Model mm) {
		
		List<BoardDTO> mainData = bm.list();
		//System.out.println("mainData:"+mainData);
		mm.addAttribute("mainData", mainData);
		return "db/list";
	}
	
	@RequestMapping("/db/detail/{id}")
	String dbDetail(Model mm, BoardDTO dto) {
		
		mm.addAttribute("mainData", bm.detail(dto));
		return "db/detail";
	}
	
	@GetMapping("/db/insert")
	String dbInsertForm(BoardDTO dto) {
		return "db/insertForm";
	}
	
	@PostMapping("/db/insert")
	String  dbInsertComplete(Model mm, BoardDTO dto) {
		bm.inserttt(dto);
		mm.addAttribute("msg", "입력되었습니다.");
		mm.addAttribute("goUrl", "list");
		return "db/alert";
	}
	
	@GetMapping("/db/delete/{id}")
	String dbDeleteForm(BoardDTO dto) {
		return "db/DeleteForm";
	}
	@PostMapping("/db/delete/{id}")
	String dbDeleteComplete(Model mm,BoardDTO dto) {
		int cnt = bm.deleteee(dto);
		
		System.out.println("삭제갯수:"+cnt);
		mm.addAttribute("msg", "삭제되었습니다.");
		mm.addAttribute("goUrl", "/db/list");
		return "db/alert";
	}
}
